Not all gpus support fp16 training! Will use fp32 instead.
2023-07-02 12:30:46,687 - 0:00:06 - 0.0s - INFO - __main__ - args = Namespace(adam_epsilon=0.0001, add_task_tokens=False, data_dir='../../data', debug=False, decay_style='linear', device_ids=[0], dynamic_epochs=False, fp32=False, gen_lm_sample_percentage=0.0, learning_rate=6.25e-05, lm_lambda=0.0, logging_steps=1000, lr_schedule='warmup_linear', max_grad_norm=1, max_len=1024, max_n_epochs=9, memory_sizes=[40537.0], min_batch_size=4, min_n_steps=1500, model_dir_root='../../model_aamm2/gpt2/lll/wikisql_ag_amazon_sst_srl_woz.en_0.0', model_name='gpt2', n_gpus=1, n_train_epochs={'wikisql': 20, 'ag': 20, 'amazon': 20, 'sst': 20, 'srl': 20, 'woz.en': 20}, n_warmup_ratio=0.005, n_workers=25, qp_margin=0.5, real_sample=False, reg_lambda=1.0, seed=42, seq_train_type='lll', skip_tasks=None, tasks=['wikisql', 'ag', 'amazon', 'sst', 'srl', 'woz.en'], temperature_lm=1.0, temperature_qa=1.0, test_batch_size=[14187], tokens_weight=5, top_k_lm=20, top_k_qa=20, top_p_lm=0.0, top_p_qa=0.0, train_batch_size=[14187], unbound=0, use_sep=False, weight_decay=0.01)
2023-07-02 12:30:57,846 - 0:00:17 - 11.2s - INFO - __main__ - task: wikisql, epoch: 20
2023-07-02 12:30:57,847 - 0:00:17 - 0.0s - INFO - __main__ - start to test { task: wikisql (load) wikisql (eval), seq train type: lll }
2023-07-02 12:32:03,341 - 0:01:23 - 65.5s - INFO - __main__ - len of test dataset: 15878
2023-07-03 10:45:35,284 - 22:14:55 - 80011.9s - INFO - __main__ - score: {'wikisql': OrderedDict([('lfem', 69.6687240206575), ('em', 41.71180249401688), ('nf1', 90.33183464705989), ('nem', 46.088928076583954)]), 'ag': None, 'amazon': None, 'sst': None, 'srl': None, 'woz.en': None}
2023-07-03 10:45:46,054 - 22:15:06 - 10.8s - INFO - __main__ - task: ag, epoch: 20
2023-07-03 10:45:46,054 - 22:15:06 - 0.0s - INFO - __main__ - start to test { task: ag (load) ag (eval), seq train type: lll }
2023-07-03 10:45:47,675 - 22:15:07 - 1.6s - INFO - __main__ - len of test dataset: 7600
2023-07-03 11:12:51,918 - 22:42:11 - 1624.2s - INFO - __main__ - score: {'wikisql': None, 'ag': OrderedDict([('em', 94.17105263157895), ('nf1', 94.17105263157895), ('nem', 94.17105263157895)]), 'amazon': None, 'sst': None, 'srl': None, 'woz.en': None}
2023-07-03 11:13:02,860 - 22:42:22 - 10.9s - INFO - __main__ - task: amazon, epoch: 20
2023-07-03 11:13:02,860 - 22:42:22 - 0.0s - INFO - __main__ - start to test { task: amazon (load) amazon (eval), seq train type: lll }
2023-07-03 11:13:04,946 - 22:42:24 - 2.1s - INFO - __main__ - len of test dataset: 7600
2023-07-03 11:37:14,352 - 23:06:34 - 1449.4s - INFO - __main__ - score: {'wikisql': None, 'ag': None, 'amazon': OrderedDict([('em', 63.03947368421052), ('nf1', 75.65789473684282), ('nem', 63.03947368421052)]), 'sst': None, 'srl': None, 'woz.en': None}
2023-07-03 11:37:25,056 - 23:06:45 - 10.7s - INFO - __main__ - task: sst, epoch: 20
2023-07-03 11:37:25,056 - 23:06:45 - 0.0s - INFO - __main__ - start to test { task: sst (load) sst (eval), seq train type: lll }
2023-07-03 11:37:26,479 - 23:06:46 - 1.4s - INFO - __main__ - len of test dataset: 1821
2023-07-03 11:37:28,983 - 23:06:48 - 2.5s - INFO - __main__ - score: {'wikisql': None, 'ag': None, 'amazon': None, 'sst': OrderedDict([('em', 90.11532125205932), ('nf1', 90.11532125205932), ('nem', 90.11532125205932)]), 'srl': None, 'woz.en': None}
2023-07-03 11:37:39,961 - 23:06:59 - 11.0s - INFO - __main__ - task: srl, epoch: 20
2023-07-03 11:37:39,961 - 23:06:59 - 0.0s - INFO - __main__ - start to test { task: srl (load) srl (eval), seq train type: lll }
2023-07-03 11:37:41,844 - 23:07:01 - 1.9s - INFO - __main__ - len of test dataset: 2201
2023-07-03 12:00:33,167 - 23:29:53 - 1371.3s - INFO - __main__ - score: {'wikisql': None, 'ag': None, 'amazon': None, 'sst': None, 'srl': OrderedDict([('em', 50.567923671058615), ('nf1', 69.46508574817551), ('nem', 56.019990913221264)]), 'woz.en': None}
2023-07-03 12:00:44,342 - 23:30:04 - 11.2s - INFO - __main__ - task: woz.en, epoch: 20
2023-07-03 12:00:44,342 - 23:30:04 - 0.0s - INFO - __main__ - start to test { task: woz.en (load) woz.en (eval), seq train type: lll }
2023-07-03 12:00:46,074 - 23:30:06 - 1.7s - INFO - __main__ - len of test dataset: 1646
2023-07-03 12:11:59,942 - 23:41:19 - 673.9s - INFO - __main__ - score: {'wikisql': None, 'ag': None, 'amazon': None, 'sst': None, 'srl': None, 'woz.en': OrderedDict([('em', 16.828675577156744), ('nf1', 94.06498860933854), ('nem', 86.26974483596598), ('joint_goal_em', 85.54070473876064), ('turn_request_em', 91.98055893074118), ('turn_goal_em', 90.94775212636695), ('avg_dialogue', 88.76063183475091)])}
